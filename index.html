<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Photopea Gemini AI Edit</title>
<style>
    body { font-family: Arial, sans-serif; margin: 10px; background: #f5f5f5; }
    label { display:block; margin-top:10px; }
    textarea { width:100%; height:80px; }
    select, button { padding:5px; margin-top:5px; }
</style>
<script>
let lang = 'en';
function switchLang() {
    lang = document.getElementById('lang').value;
    document.body.dir = (lang === 'ar') ? 'rtl' : 'ltr';
    document.getElementById('promptLabel').textContent = (lang === 'ar') ? 'اكتب وصف التعديل' : 'Enter edit description';
    document.getElementById('btnRun').textContent = (lang === 'ar') ? 'تشغيل' : 'Run';
}
async function runEdit() {
    const prompt = document.getElementById('prompt').value;
    const apiKey = document.getElementById('apiKey').value;
    const mask = app.activeDocument.selection; // hypothetical mask object in Photopea
    
    const resp = await fetch("https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash-latest:generateContent?key=" + apiKey, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
            contents: [ { parts: [ { text: "Photo edit instruction: " + prompt } ] } ]
        })
    });
    const data = await resp.json();
    alert((lang === 'ar' ? 'استجابة الذكاء الاصطناعي:' : 'AI Response:') + "\n" + JSON.stringify(data));
}
</script>
</head>
<body>
    <label>Language / اللغة</label>
    <select id="lang" onchange="switchLang()">
        <option value="en">English</option>
        <option value="ar">العربية</option>
    </select>
    
    <label for="apiKey">Gemini API Key</label>
    <input type="text" id="apiKey" placeholder="Enter your Gemini API Key" />
    
    <label id="promptLabel" for="prompt">Enter edit description</label>
    <textarea id="prompt"></textarea>
    
    <button id="btnRun" onclick="runEdit()">Run</button>
</body>
</html>